<!DOCTYPE html>
<html lang="tr" dir="ltr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Adalya Company - Giri≈ü</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üîê</text></svg>">
  
  <style>
    :root{
      --gold:#d4af37;
      --gold-dark:#b8941f;
      --bg-light:#f5f7fa;
      --surface:#ffffff;
      --text:#2c3e50;
      --error:#e74c3c;
      --border:#e0e0e0;
    }
    *{box-sizing:border-box;margin:0;padding:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif}
    body{
      min-height:100vh;display:flex;align-items:center;justify-content:center;
      background:var(--bg-light);color:var(--text);padding:16px
    }
    .login-box{
      width:100%;max-width:380px;background:var(--surface);
      border-radius:20px;padding:40px 24px;
      box-shadow:0 8px 30px rgba(0,0,0,.08);text-align:center
    }
    .logo-box{
      width:120px;height:120px;margin:0 auto 12px;border-radius:50%;
      background:#fff;border:4px solid var(--gold);
      display:flex;align-items:center;justify-content:center;overflow:hidden
    }
    .logo-box img{width:88%;height:88%;object-fit:contain}
    @media (min-width:480px){.logo-box{width:144px;height:144px}}

    .brand{display:flex;flex-direction:column;gap:4px;margin-bottom:24px}
    .brand .company{font-size:1.1rem;font-weight:700;color:var(--text)}
    .brand .form-title{font-size:1.25rem;font-weight:800;color:var(--gold)}

    input{
      width:100%;padding:14px 16px;margin-bottom:16px;
      background:#fff;border:1.5px solid var(--border);
      border-radius:12px;font-size:1rem;transition:.3s
    }
    input:focus{outline:none;border-color:var(--gold);box-shadow:0 0 0 3px rgba(212,175,55,.2)}
    button{
      width:100%;padding:14px;background:var(--gold);color:#fff;
      font-size:1rem;font-weight:700;border:none;border-radius:12px;
      cursor:pointer;transition:.3s
    }
    button:hover{background:var(--gold-dark);transform:translateY(-2px)}
    .error{display:none;color:var(--error);font-size:.85rem;margin-top:-10px;margin-bottom:10px}

    .lang-float{
      position:fixed;bottom:16px;right:16px;z-index:999;
      display:flex;gap:6px;background:rgba(255,255,255,.85);
      backdrop-filter:blur(6px);padding:6px;border-radius:30px;
      box-shadow:0 4px 18px rgba(0,0,0,.15)
    }
    .lang-float button{
      min-width:64px;height:40px;border:none;border-radius:20px;
      font-size:.9rem;font-weight:700;cursor:pointer;
      background:#fff;color:var(--text);transition:transform .2s
    }
    .lang-float button:active{transform:scale(.92)}
    .lang-float button.active{background:var(--gold);color:#fff}

    .loading {
      opacity: 0.7;
      pointer-events: none;
    }

    .debug-info {
      position: fixed;
      top: 10px;
      left: 10px;
      background: rgba(0,0,0,0.8);
      color: white;
      padding: 8px 12px;
      border-radius: 6px;
      font-size: 0.8rem;
      z-index: 1000;
      display: none;
    }
  </style>
</head>

<body>
<!-- Debug info for testing -->
<div class="debug-info" id="debug-info"></div>

<div class="login-box">
  <div class="logo-box">
    <img src="images/adalyalogo.jpg" alt="Adalya Logo" onerror="this.src='data:image/svg+xml,<svg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 100 100\'><rect width=\'100\' height=\'100\' fill=\'%23d4af37\'/><text x=\'50\' y=\'60\' font-family=\'Arial\' font-size=\'40\' text-anchor=\'middle\' fill=\'white\'>A</text></svg>'">
  </div>

  <div class="brand">
    <div class="company">Adalya Company</div>
    <div class="form-title">Sipari≈ü Formu</div>
  </div>

  <input type="text" id="user" placeholder="Kullanƒ±cƒ± adƒ±" autocomplete="username">
  <input type="password" id="pass" placeholder="≈ûifre" autocomplete="current-password">

  <div class="error" id="msg">Kullanƒ±cƒ± adƒ± veya ≈üifre yanlƒ±≈ü!</div>

  <button onclick="giris()" id="login-btn">Giri≈ü</button>
</div>

<div class="lang-float">
  <button class="active" data-lang="tr">T√ºrk√ße</button>
  <button data-lang="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</button>
  <button data-lang="en">English</button>
</div>

<script>
// KULLANICI Lƒ∞STESƒ∞ - GitHub'dan √ßekilecek
const USERS_URL = 'https://raw.githubusercontent.com/XwinSherin/UAE-Order/main/users.json';

// Geli≈ütirilmi≈ü yerel kullanƒ±cƒ± listesi (backup olarak)
const localUsers = [
  { user: "omer", pass: "1" },
  { user: "ahmet", pass: "1234" },
  { user: "mehmet", pass: "1234" },
  { user: "ayse", pass: "1234" },
  { user: "admin", pass: "admin123" },
  { user: "demo", pass: "demo123" },
  { user: "test", pass: "test123" }
];

// Debug fonksiyonu
function debugLog(message) {
  console.log(message);
  const debugEl = document.getElementById('debug-info');
  if (debugEl) {
    debugEl.textContent = message;
    debugEl.style.display = 'block';
    setTimeout(() => debugEl.style.display = 'none', 3000);
  }
}

// Dƒ∞L Y√ñNETƒ∞Mƒ∞
function setLang(lang, element = null){
  try {
    localStorage.setItem('lang', lang);
    document.documentElement.lang = lang;
    document.documentElement.dir = (lang === 'ar' ? 'rtl' : 'ltr');
    
    const texts = {
      tr: {
        title: "Adalya Company - Giri≈ü",
        company: "Adalya Company", 
        formTitle: "Sipari≈ü Formu",
        userPlaceholder: "Kullanƒ±cƒ± adƒ±",
        passPlaceholder: "≈ûifre",
        error: "Kullanƒ±cƒ± adƒ± veya ≈üifre yanlƒ±≈ü!",
        login: "Giri≈ü",
        required: "Kullanƒ±cƒ± adƒ± ve ≈üifre gerekli!"
      },
      ar: {
        title: "ÿ£ÿØÿßŸÑŸäÿß - ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ",
        company: "ÿ¥ÿ±ŸÉÿ© ÿ£ÿØÿßŸÑŸäÿß",
        formTitle: "ŸÜŸÖŸàÿ∞ÿ¨ ÿßŸÑÿ∑ŸÑÿ®", 
        userPlaceholder: "ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ",
        passPlaceholder: "ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±",
        error: "ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ£Ÿà ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ÿÆÿßÿ∑ÿ¶ÿ©!",
        login: "ÿØÿÆŸàŸÑ",
        required: "ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸàŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ŸÖÿ∑ŸÑŸàÿ®ÿßŸÜ!"
      },
      en: {
        title: "Adalya Company - Login",
        company: "Adalya Company",
        formTitle: "Order Form",
        userPlaceholder: "Username", 
        passPlaceholder: "Password",
        error: "Wrong username or password!",
        login: "Login",
        required: "Username and password are required!"
      }
    };
    
    const t = texts[lang];
    if (t) {
      document.title = t.title;
      const companyEl = document.querySelector('.company');
      const formTitleEl = document.querySelector('.form-title');
      const userInput = document.getElementById('user');
      const passInput = document.getElementById('pass');
      const msgEl = document.getElementById('msg');
      const loginBtn = document.getElementById('login-btn');
      
      if (companyEl) companyEl.textContent = t.company;
      if (formTitleEl) formTitleEl.textContent = t.formTitle;
      if (userInput) userInput.placeholder = t.userPlaceholder;
      if (passInput) passInput.placeholder = t.passPlaceholder;
      if (msgEl) {
        msgEl.textContent = t.error;
        // Hata mesajƒ±nƒ± dil deƒüi≈üince gizle
        msgEl.style.display = 'none';
      }
      if (loginBtn) loginBtn.textContent = t.login;
    }
    
    // Aktif butonu g√ºncelle
    document.querySelectorAll('.lang-float button').forEach(btn => {
      if (btn && btn.classList) {
        btn.classList.toggle('active', btn.dataset.lang === lang);
      }
    });
    
  } catch (error) {
    console.error('Dil deƒüi≈ütirme hatasƒ±:', error);
  }
}

// Gƒ∞Rƒ∞≈û FONKSƒ∞YONU
async function giris(){
  const u = document.getElementById('user').value.trim();
  const p = document.getElementById('pass').value.trim();
  const msg = document.getElementById('msg');
  const loginBtn = document.getElementById('login-btn');
  
  // Hata mesajƒ±nƒ± gizle
  msg.style.display = 'none';
  
  if (!u || !p) {
    const currentLang = localStorage.getItem('lang') || 'tr';
    const requiredTexts = {
      tr: "Kullanƒ±cƒ± adƒ± ve ≈üifre gerekli!",
      ar: "ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸàŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ŸÖÿ∑ŸÑŸàÿ®ÿßŸÜ!",
      en: "Username and password are required!"
    };
    msg.textContent = requiredTexts[currentLang] || requiredTexts.tr;
    msg.style.display = 'block';
    return;
  }

  // Loading state
  const originalText = loginBtn.textContent;
  loginBtn.textContent = 'Giri≈ü yapƒ±lƒ±yor...';
  loginBtn.disabled = true;
  document.body.classList.add('loading');

  let users = [];
  let source = 'local';
  
  try {
    debugLog('GitHub\'dan kullanƒ±cƒ± listesi √ßekiliyor...');
    
    // √ñnce GitHub'dan kullanƒ±cƒ±larƒ± √ßek
    const res = await fetch(USERS_URL + '?t=' + new Date().getTime()); // Cache bypass
    
    if (res.ok) {
      const data = await res.json();
      debugLog('GitHub\'dan alƒ±nan kullanƒ±cƒ±lar: ' + data.length + ' adet');
      
      if (Array.isArray(data)) {
        users = data;
        source = 'github';
      } else {
        throw new Error('Ge√ßersiz veri formatƒ±');
      }
    } else {
      throw new Error(`HTTP ${res.status}: ${res.statusText}`);
    }
  } catch (err) {
    // GitHub'dan √ßekilemezse yerel listeyi kullan
    debugLog('GitHub baƒülantƒ± hatasƒ±, yerel kullanƒ±cƒ±lar kullanƒ±lƒ±yor');
    users = localUsers;
    source = 'local';
  }

  debugLog(`Kullanƒ±cƒ± kaynaƒüƒ±: ${source}, Toplam kullanƒ±cƒ±: ${users.length}`);

  // Kullanƒ±cƒ± adƒ± ve ≈üifre kontrol√º (case-insensitive)
  const found = users.find(x => 
    x.user.toLowerCase() === u.toLowerCase() && 
    x.pass === p
  );
  
  if (found) {
    debugLog('Giri≈ü ba≈üarƒ±lƒ±! Kullanƒ±cƒ±: ' + found.user);
    sessionStorage.setItem('currentUser', u);
    sessionStorage.setItem('currentUserUpper', u.toUpperCase());
    sessionStorage.setItem('loginTime', new Date().toISOString());
    
    // Ba≈üarƒ±lƒ± giri≈ü mesajƒ±
    const currentLang = localStorage.getItem('lang') || 'tr';
    const successTexts = {
      tr: 'Giri≈ü ba≈üarƒ±lƒ±! Y√∂nlendiriliyor...',
      ar: 'ÿ™ŸÖ ÿßŸÑÿØÿÆŸàŸÑ ÿ®ŸÜÿ¨ÿßÿ≠! Ÿäÿ™ŸÖ ÿßŸÑÿ™Ÿàÿ¨ŸäŸá...',
      en: 'Login successful! Redirecting...'
    };
    
    loginBtn.textContent = successTexts[currentLang] || successTexts.tr;
    
    // 1 saniye sonra y√∂nlendir
    setTimeout(() => {
      window.location.href = 'siparis.html';
    }, 1000);
    
  } else {
    debugLog('Giri≈ü ba≈üarƒ±sƒ±z. Kullanƒ±cƒ±: ' + u);
    
    // Hata mesajƒ±nƒ± g√∂ster
    msg.style.display = 'block';
    
    // Butonu resetle
    const currentLang = localStorage.getItem('lang') || 'tr';
    const loginTexts = {
      tr: 'Giri≈ü',
      ar: 'ÿØÿÆŸàŸÑ', 
      en: 'Login'
    };
    
    loginBtn.textContent = loginTexts[currentLang] || loginTexts.tr;
    loginBtn.disabled = false;
    document.body.classList.remove('loading');
  }
}

// SAYFA Y√úKLENDƒ∞ƒûƒ∞NDE
document.addEventListener('DOMContentLoaded', function() {
  debugLog('Login sayfasƒ± y√ºklendi');
  
  // Dil butonlarƒ±na event listener ekle
  document.querySelectorAll('.lang-float button').forEach(btn => {
    btn.addEventListener('click', function() {
      setLang(this.dataset.lang, this);
    });
  });
  
  // Varsayƒ±lan dili ayarla
  const savedLang = localStorage.getItem('lang') || 'tr';
  setLang(savedLang);
  
  // Enter tu≈üu ile giri≈ü yapma
  document.getElementById('pass').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
      giris();
    }
  });
  
  // Kullanƒ±cƒ± adƒ± input'una focus
  document.getElementById('user').focus();
  
  // Debug i√ßin test kullanƒ±cƒ±sƒ± (sadece development'ta)
  if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
    debugLog('Development modu - Test kullanƒ±cƒ±larƒ± hazƒ±r');
    // Otomatik doldurma i√ßin (isteƒüe baƒülƒ±)
    // document.getElementById('user').value = 'omer';
    // document.getElementById('pass').value = '1';
  }
});
</script>
</body>
</html>